<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="styles.css">
    <title>Techxas Student Site</title>
    <script>
        function swapTab(h, s) {
            document.getElementById(s).style.display = 'inline';
            document.getElementById(h).style.display = 'none';
            document.getElementById(s+"Button").classList.add('CurrentTab');
            document.getElementById(s+"Button").classList.remove('InactiveTab');
            document.getElementById(h+"Button").classList.remove('CurrentTab');
            document.getElementById(h+"Button").classList.add('InactiveTab');
        }

        function enableCell(m, n, e, dl){
            var mod;
            if (m) { mod = 's'; } else { mod = 'h'; }
            if (document.getElementById(n+mod+e+'Button').classList.contains('SelectedCell')) {
                document.getElementById(n+mod+e+'Button').classList.remove('SelectedCell');
                document.getElementById(n+mod+e+'Button').classList.add('InactiveCell');
                document.getElementById(n+mod+e+'Cell').style.display = 'none';
            } else {
            document.getElementById(n+mod+e+'Button').classList.add('SelectedCell');
            document.getElementById(n+mod+e+'Button').classList.remove('InactiveCell');
            document.getElementById(n+mod+e+'Cell').style.display = 'block';
            }
            for (let d in dl) {
                document.getElementById(n+mod+dl[d]+'Cell').style.display = 'none';
                if (document.getElementById(n+mod+dl[d]+'Button').classList.contains('SelectedCell')) {
                    document.getElementById(n+mod+dl[d]+'Button').classList.remove('SelectedCell');
                    document.getElementById(n+mod+dl[d]+'Button').classList.add('InactiveCell');
                }
            }
        }

        var softwareProj;
        var hardwareProj;
        async function fetchPrivateSheet() {
            const apiKey = "AIzaSyCE-rKpVbm6l23iLdmD5mIWpvOiAnOh4oo";
            const sheetID = "1fQmtzIvjzD_6DSqiuy9-txca9QZQ4Z_0eLRKi0pWTk0";
            const rangeSoft = "Sheet1!G2:L50";  // Specify your data range
            const rangeHard = "Sheet1!N2:S50";
            const urlSoft = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${rangeSoft}?key=${apiKey}`;
            const urlHard = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${rangeHard}?key=${apiKey}`;

            const responseSoft = await fetch(urlSoft);
            const responseHard = await fetch(urlHard);
            const dataSoft = await responseSoft.json();
            const dataHard = await responseHard.json();

            softwareProj = new Array(dataSoft.values.length);
            hardwareProj = new Array(dataHard.values.length);

            for (var i = (softwareProj.length-1); i >= 0; i--) {
                let tempArray = [dataSoft.values[i][0],dataSoft.values[i][1]];
                if (dataSoft.values[i][2] != undefined){ tempArray.push(dataSoft.values[i][2]); } else { tempArray.push("<"); }
                if (dataSoft.values[i][3] != undefined){ tempArray.push(dataSoft.values[i][3]); } else { tempArray.push("<"); }
                if (dataSoft.values[i][4] != undefined){ tempArray.push(dataSoft.values[i][4]); } else { tempArray.push("<"); }
                if (dataSoft.values[i][5] != undefined){ tempArray.push(dataSoft.values[i][5]); } else { tempArray.push("<"); }
                softwareProj[softwareProj.length - i - 1] = tempArray;
            }
            for (var i = (hardwareProj.length-1); i >= 0; i--) {
                let tempArray = [dataHard.values[i][0],dataHard.values[i][1]];
                if (dataHard.values[i][2] != undefined){ tempArray.push(dataHard.values[i][2]); } else { tempArray.push("<"); }
                if (dataHard.values[i][3] != undefined){ tempArray.push(dataHard.values[i][3]); } else { tempArray.push("<"); }
                if (dataHard.values[i][4] != undefined){ tempArray.push(dataHard.values[i][4]); } else { tempArray.push("<"); }
                if (dataHard.values[i][5] != undefined){ tempArray.push(dataHard.values[i][5]); } else { tempArray.push("<"); }
                hardwareProj[hardwareProj.length - i - 1] = tempArray;
            }
        }

        (async function() {
            await fetchPrivateSheet();
            const endDiv = document.getElementById("EOFsoft");
            const endDivHard = document.getElementById("EOFhard");

            //Hardware
            for (let k in hardwareProj)  { // https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement

                const newDiv = document.createElement("div");
                const newTitle = document.createElement("p");
                const newDesc = document.createElement("p");

                var contentTypes = new Array(0);

                newDiv.appendChild(newTitle);
                newDiv.appendChild(newDesc);

                const imgButton = document.createElement("input"); const codeButton = document.createElement("input");
                const srcButton = document.createElement("input"); const filesButton = document.createElement("input");
                const imgDiv = document.createElement("div"); const codeDiv = document.createElement("div");
                const srcDiv = document.createElement("div"); const fileDiv = document.createElement("div");
                if (!hardwareProj[k][2].includes("<")) { imgButton.value = "Images"; newDiv.appendChild(imgButton); imgButton.type = 'Button';
                                                         imgButton.classList.add('InactiveCell'); imgButton.id = k+'hImageButton'; contentTypes.push('Image');
                                                         imgDiv.classList.add('CellContent');
                                                         imgDiv.style = "display: none;"; imgDiv.id = k+'hImageCell';

                                                         var imgFiles = new Array(0); var tempWord = "";
                                                         for (let i = 0; i<hardwareProj[k][2].length; i++){
                                                            currChar = hardwareProj[k][2].substring(i,i+1)
                                                            if(currChar !== '&'){ tempWord += currChar; } else { imgFiles.push(tempWord); tempWord = ""; }
                                                         }
                                                         imgFiles.push(tempWord);

                                                         for (let i = 0; i<imgFiles.length; i++){
                                                            var insIndex = imgFiles[i].indexOf('>');
                                                            const newImg = document.createElement('img'); newImg.src = "assets/"+imgFiles[i].substring(0,insIndex);
                                                            newImg.classList.add(imgFiles[i].substring(insIndex+1,imgFiles[i].length));
                                                            imgDiv.appendChild(newImg);
                                                         }

                }
                if (!hardwareProj[k][3].includes("<")) { codeButton.value = "Code"; newDiv.appendChild(codeButton); codeButton.type = 'Button';
                                                         codeButton.classList.add('InactiveCell'); codeButton.id = k+'hCodeButton'; contentTypes.push('Code');
                                                         codeDiv.classList.add('CellContent');
                                                         codeDiv.style = "display: none;"; codeDiv.id = k+'hCodeCell';

                                                         var codeFiles = new Array(0); var tempWord = "";
                                                         for (let i = 0; i<hardwareProj[k][3].length; i++){
                                                            currChar = hardwareProj[k][3].substring(i,i+1)
                                                            if(currChar !== '&'){ tempWord += currChar; } else { codeFiles.push(tempWord); tempWord = ""; }
                                                         }
                                                         codeFiles.push(tempWord);

                                                         for (let i = 0; i<codeFiles.length; i++){
                                                            const newCode = document.createElement('embed'); newCode.src = "code/"+codeFiles[i];
                                                            newCode.classList.add('CodeEmbed');
                                                            codeDiv.appendChild(newCode);
                                                         }
                }
                if (!hardwareProj[k][4].includes("<")) { srcButton.value = "Sources"; newDiv.appendChild(srcButton); srcButton.type = 'Button';
                                                         srcButton.classList.add('InactiveCell'); srcButton.id = k+'hSourceButton'; contentTypes.push('Source');
                                                         srcDiv.classList.add('CellContent');
                                                         srcDiv.style = "display: none;"; srcDiv.id = k+'hSourceCell';

                                                         const newSource = document.createElement('embed'); newSource.src = "code/"+hardwareProj[k][4];
                                                         newSource.classList.add('SourceEmbed');
                                                         srcDiv.appendChild(newSource);
                }
                if (!hardwareProj[k][5].includes("<")) { filesButton.value = "Files"; newDiv.appendChild(filesButton); filesButton.type = 'Button';
                                                         filesButton.classList.add('InactiveCell'); filesButton.id = k+'hFilesButton'; contentTypes.push('Files');
                                                         fileDiv.classList.add('CellContent');
                                                         fileDiv.style = "display: none;"; fileDiv.id = k+'hFilesCell';

                                                         var fileFiles = new Array(0); var tempWord = "";
                                                         for (let i = 0; i<hardwareProj[k][5].length; i++){
                                                            currChar = hardwareProj[k][5].substring(i,i+1)
                                                            if(currChar !== '&'){ tempWord += currChar; } else { fileFiles.push(tempWord); tempWord = ""; }
                                                         }
                                                         fileFiles.push(tempWord);

                                                         for (let i = 0; i<fileFiles.length; i++){
                                                            const newFile = document.createElement('a'); newFile.href = "code/"+fileFiles[i];
                                                            newFile.download = "code/"+fileFiles[i];
                                                            newFile.classList.add('FileDownload');
                                                            newFile.textContent = "Download " + fileFiles[i] + "\n\n";
                                                            fileDiv.appendChild(newFile);
                                                         }
                }

                var indexLen = contentTypes.length;
                var imgIndex = contentTypes.indexOf('Image'); var codeIndex = contentTypes.indexOf('Code'); var srcIndex = contentTypes.indexOf('Source'); var fileIndex = contentTypes.indexOf('Files');
                var imgContentTypes = contentTypes.filter((_, i) => i !== imgIndex); var codeContentTypes = contentTypes.filter((_, i) => i !== codeIndex);
                var srcContentTypes = contentTypes.filter((_, i) => i !== srcIndex); var fileContentTypes = contentTypes.filter((_, i) => i !== fileIndex);

                var firstTab = true;
                if (imgIndex !== -1) { if (firstTab) { firstTab = false; imgButton.style = "margin-left = 18px;"; } newDiv.appendChild(imgDiv); imgButton.onclick = () => enableCell(false, k, 'Image', imgContentTypes); }
                if (codeIndex !== -1) { if (firstTab) { firstTab = false; codeButton.style = "margin-left = 18px;"; } newDiv.appendChild(codeDiv); codeButton.onclick = () => enableCell(false, k, 'Code', codeContentTypes); }
                if (srcIndex !== -1) { if (firstTab) { firstTab = false; srcButton.style = "margin-left = 18px;"; } newDiv.appendChild(srcDiv); srcButton.onclick = () => enableCell(false, k, 'Source', srcContentTypes); }
                if (fileIndex !== -1) { if (firstTab) { firstTab = false; fileButton.style = "margin-left = 18px;"; } newDiv.appendChild(fileDiv); filesButton.onclick = () => enableCell(false, k, 'Files', fileContentTypes); }

                newTitle.textContent = hardwareProj[k][0];
                newDesc.textContent = hardwareProj[k][1];

                if (k%2==0) { newDiv.classList.add('Content'); }
                else { newDiv.classList.add('ContentOffset'); }

                if ((k%4==0) or (k%4==2)) { newDiv.style = "float: left;"; }
                else { newDiv.style = "float: right;"; }

                newTitle.classList.add('cHeading');
                newDesc.classList.add('ResumeText');

                const hardwareDiv = document.getElementById("Hardware");
                hardwareDiv.insertBefore(newDiv, EOFhard);
            }

            //Software
            for (let k in softwareProj)  { // https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement

                const newDiv = document.createElement("div");
                const newTitle = document.createElement("p");
                const newDesc = document.createElement("p");

                var contentTypes = new Array(0);

                newDiv.appendChild(newTitle);
                newDiv.appendChild(newDesc);

                const imgButton = document.createElement("input"); const codeButton = document.createElement("input");
                const srcButton = document.createElement("input"); const filesButton = document.createElement("input");
                const imgDiv = document.createElement("div"); const codeDiv = document.createElement("div");
                const srcDiv = document.createElement("div"); const fileDiv = document.createElement("div");
                if (!softwareProj[k][2].includes("<")) { imgButton.value = "Images"; newDiv.appendChild(imgButton); imgButton.type = 'Button';
                                                         imgButton.classList.add('InactiveCell'); imgButton.id = k+'sImageButton'; contentTypes.push('Image');
                                                         imgDiv.classList.add('CellContent');
                                                         imgDiv.style = "display: none;"; imgDiv.id = k+'sImageCell';

                                                         var imgFiles = new Array(0); var tempWord = "";
                                                         for (let i = 0; i<softwareProj[k][2].length; i++){
                                                            currChar = softwareProj[k][2].substring(i,i+1)
                                                            if(currChar !== '&'){ tempWord += currChar; } else { imgFiles.push(tempWord); tempWord = ""; }
                                                         }
                                                         imgFiles.push(tempWord);

                                                         for (let i = 0; i<imgFiles.length; i++){
                                                            var insIndex = imgFiles[i].indexOf('>');
                                                            const newImg = document.createElement('img'); newImg.src = "assets/"+imgFiles[i].substring(0,insIndex);
                                                            newImg.classList.add(imgFiles[i].substring(insIndex+1,imgFiles[i].length));
                                                            imgDiv.appendChild(newImg);
                                                         }

                }
                if (!softwareProj[k][3].includes("<")) { codeButton.value = "Code"; newDiv.appendChild(codeButton); codeButton.type = 'Button';
                                                         codeButton.classList.add('InactiveCell'); codeButton.id = k+'sCodeButton'; contentTypes.push('Code');
                                                         codeDiv.classList.add('CellContent');
                                                         codeDiv.style = "display: none;"; codeDiv.id = k+'sCodeCell';

                                                         var codeFiles = new Array(0); var tempWord = "";
                                                         for (let i = 0; i<softwareProj[k][3].length; i++){
                                                            currChar = softwareProj[k][3].substring(i,i+1)
                                                            if(currChar !== '&'){ tempWord += currChar; } else { codeFiles.push(tempWord); tempWord = ""; }
                                                         }
                                                         codeFiles.push(tempWord);

                                                         for (let i = 0; i<codeFiles.length; i++){
                                                            const newCode = document.createElement('embed'); newCode.src = "code/"+codeFiles[i];
                                                            newCode.classList.add('CodeEmbed');
                                                            codeDiv.appendChild(newCode);
                                                         }
                }
                if (!softwareProj[k][4].includes("<")) { srcButton.value = "Sources"; newDiv.appendChild(srcButton); srcButton.type = 'Button';
                                                         srcButton.classList.add('InactiveCell'); srcButton.id = k+'sSourceButton'; contentTypes.push('Source');
                                                         srcDiv.classList.add('CellContent');
                                                         srcDiv.style = "display: none;"; srcDiv.id = k+'sSourceCell';

                                                         const newSource = document.createElement('embed'); newSource.src = "code/"+softwareProj[k][4];
                                                         newSource.classList.add('SourceEmbed');
                                                         srcDiv.appendChild(newSource);
                }
                if (!softwareProj[k][5].includes("<")) { filesButton.value = "Files"; newDiv.appendChild(filesButton); filesButton.type = 'Button';
                                                         filesButton.classList.add('InactiveCell'); filesButton.id = k+'sFilesButton'; contentTypes.push('Files');
                                                         fileDiv.classList.add('CellContent');
                                                         fileDiv.style = "display: none;"; fileDiv.id = k+'sFilesCell';

                                                         var fileFiles = new Array(0); var tempWord = "";
                                                         for (let i = 0; i<softwareProj[k][5].length; i++){
                                                            currChar = softwareProj[k][5].substring(i,i+1)
                                                            if(currChar !== '&'){ tempWord += currChar; } else { fileFiles.push(tempWord); tempWord = ""; }
                                                         }
                                                         fileFiles.push(tempWord);

                                                         for (let i = 0; i<fileFiles.length; i++){
                                                            const newFile = document.createElement('a'); newFile.href = "code/"+fileFiles[i];
                                                            newFile.download = "code/"+fileFiles[i];
                                                            newFile.classList.add('FileDownload');
                                                            newFile.textContent = "Download " + fileFiles[i];
                                                            const lineBreak = document.createElement('br');
                                                            fileDiv.appendChild(newFile);
                                                            fileDiv.appendChild(lineBreak);
                                                         }
                }

                var indexLen = contentTypes.length;
                var imgIndex = contentTypes.indexOf('Image'); var codeIndex = contentTypes.indexOf('Code'); var srcIndex = contentTypes.indexOf('Source'); var fileIndex = contentTypes.indexOf('Files');
                var imgContentTypes = contentTypes.filter((_, i) => i !== imgIndex); var codeContentTypes = contentTypes.filter((_, i) => i !== codeIndex);
                var srcContentTypes = contentTypes.filter((_, i) => i !== srcIndex); var fileContentTypes = contentTypes.filter((_, i) => i !== fileIndex);

                var firstTab = true;
                if (imgIndex !== -1) { if (firstTab) { firstTab = false; imgButton.style = "margin-left = 18px;"; } newDiv.appendChild(imgDiv); imgButton.onclick = () => enableCell(true, k, 'Image', imgContentTypes); }
                if (codeIndex !== -1) { if (firstTab) { firstTab = false; codeButton.style = "margin-left = 18px;"; } newDiv.appendChild(codeDiv); codeButton.onclick = () => enableCell(true, k, 'Code', codeContentTypes); }
                if (srcIndex !== -1) { if (firstTab) { firstTab = false; srcButton.style = "margin-left = 18px;"; } newDiv.appendChild(srcDiv); srcButton.onclick = () => enableCell(true, k, 'Source', srcContentTypes); }
                if (fileIndex !== -1) { if (firstTab) { firstTab = false; fileButton.style = "margin-left = 18px;"; } newDiv.appendChild(fileDiv); filesButton.onclick = () => enableCell(true, k, 'Files', fileContentTypes); }

                newTitle.textContent = softwareProj[k][0];
                newDesc.textContent = softwareProj[k][1];

                if (k%2==0) { newDiv.classList.add('Content'); }
                else { newDiv.classList.add('ContentOffset'); }

                newTitle.classList.add('cHeading');
                newDesc.classList.add('ResumeText');

                const softwareDiv = document.getElementById("Software");
                softwareDiv.insertBefore(newDiv, EOFsoft);
            }
        })();
    </script>
</head>
<div class="Heading">
    <p>Projects</p>
    <p class="Subtitle">This page contains all of my works that I believe show off my professional ability.</p>
    <div type="NavButton">
        <input type="button" class="InactivePage" value="Home" style="margin-left: -5px;" onclick="location.href='index.html';">
        <input type="button" class="InactivePage" value="About Me" onclick="location.href='about.html';">
        <input type="button" class="CurrentPage" value="Projects">
        <input type="button" class="InactivePage" value="Contact" onclick="location.href='contact.html';">
    </div>
    <div class="NavButton">
        <input type="button" class="CurrentTab" id="SoftwareButton" value="Software" style="margin-left: -5px;" onclick="swapTab('Hardware', 'Software')">
        <input type="button" class="InactiveTab" id="HardwareButton" value="Hardware" onclick="swapTab('Software', 'Hardware')">
    </div>
</div>

<div id="Software" style="display: inline;">


    <div id="EOFsoft"></div>
</div>


</div>


<div id="Hardware" style="display: none;">

    <div id="EOFhard"></div>

</div>